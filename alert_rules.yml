groups:
- name: domain_expiry_alerts
  rules:
  - alert: DomainExpiringSoon
    expr: domain_expiry_days < 30 and domain_expiry_days > 0
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "域名即将过期"
      description: "域名 {{ $labels.domain }} 将在 {{ $value | printf \"%.0f\" }} 天后过期"

  - alert: DomainExpiringCritical
    expr: domain_expiry_days < 7 and domain_expiry_days > 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "域名紧急过期警告"
      description: "域名 {{ $labels.domain }} 将在 {{ $value | printf \"%.0f\" }} 天后过期，请立即续费！"

  - alert: DomainCheckFailed
    expr: domain_check_status == 0 or domain_expiry_days == -999
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "域名检查失败"
      description: "无法获取域名 {{ $labels.domain }} 的过期信息，请检查域名状态和WHOIS服务器连接"

  - alert: DomainExporterDown
    expr: up{job="domain-exporter"} == 0
    for: 2m
    labels:
      severity: critical
    annotations:
      summary: "域名监控服务离线"
      description: "域名过期监控服务已离线超过2分钟"